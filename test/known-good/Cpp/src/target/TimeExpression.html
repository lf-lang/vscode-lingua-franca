<span class="source-lf meta-targetspec-lflang keyword-control-lflang">
target
</span>
<span class="source-lf meta-targetspec-lflang">
 
</span>
<span class="source-lf meta-targetspec-lflang constant-language-lflang">
Cpp
</span>
<span class="source-lf meta-targetspec-lflang">
 {
</span>

<span class="source-lf meta-targetspec-lflang variable-parameter-lflang">
  timeout
</span>
<span class="source-lf meta-targetspec-lflang">
: 
</span>
<span class="source-lf meta-targetspec-lflang constant-numeric-int-lflang">
1
</span>
<span class="source-lf meta-targetspec-lflang">
 s
</span>

<span class="source-lf meta-targetspec-lflang">
}
</span>

<span class="source-lf">

</span>

<span class="source-lf keyword-control-lflang">
public
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-control-lflang">
preamble
</span>
<span class="source-lf">
 {
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>

<span class="source-lf">
  inline 
</span>
<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
Duration
</span>
<span class="source-lf">
 get_delay() { return 200ms; }
</span>

<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf">
 
</span>
<span class="source-lf entity-name-type-lflang">
Foo
</span>
<span class="source-lf">
(foo: 
</span>
<span class="source-lf storage-type-lflang">
time
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 {
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 get_delay() 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
}) {
</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
timer
</span>
<span class="source-lf">
 t(
</span>
<span class="source-lf constant-numeric-int-lflang">
0
</span>
<span class="source-lf">
, foo)
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
state
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-lflang">
timer_triggered
</span>
<span class="source-lf">
:
</span>
<span class="source-lf meta-embedded-block-cpp">
 
</span>
<span class="source-lf meta-embedded-block-cpp storage-type-lflang">
bool
</span>
<span class="source-lf meta-embedded-block-cpp">
 
</span>
<span class="source-lf">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf constant-language-lflang">
false
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(
</span>
<span class="source-lf">
t) {
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>

<span class="source-lf">
    timer_triggered 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf constant-language-lflang">
true
</span>
<span class="source-lf">
;
</span>

<span class="source-lf">
    if (get_elapsed_logical_time() 
</span>
<span class="source-lf keyword-operator-lflang">
%
</span>
<span class="source-lf">
 200ms !
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
Duration
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
zero
</span>
<span class="source-lf">
()) {
</span>

<span class="source-lf">
      
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
std
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
cerr
</span>
<span class="source-lf">
 << 
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf string-quoted-double-lflang">
ERROR: timer triggered at an unexpected time
</span>
<span class="source-lf string-quoted-double-lflang constant-character-escape">
\n
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf">
;
</span>

<span class="source-lf">
      exit(
</span>
<span class="source-lf constant-numeric-int-lflang">
4
</span>
<span class="source-lf">
);
</span>

<span class="source-lf">
    }
</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(
</span>
<span class="source-lf support-variable-lflang">
shutdown
</span>
<span class="source-lf">
) {
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>

<span class="source-lf">
    if (!timer_triggered) {
</span>

<span class="source-lf">
      
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
std
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
cerr
</span>
<span class="source-lf">
 << 
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf string-quoted-double-lflang">
ERROR: timer did not trigger
</span>
<span class="source-lf string-quoted-double-lflang constant-character-escape">
\n
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf">
;
</span>

<span class="source-lf">
      exit(
</span>
<span class="source-lf constant-numeric-int-lflang">
1
</span>
<span class="source-lf">
);
</span>

<span class="source-lf">
    }
</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
}
</span>

<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

<span class="source-lf storage-modifier-lflang">
main
</span>
<span class="source-lf">
 
</span>
<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf">
 {
</span>

<span class="source-lf">
  
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
foo
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-control-new-lflang">
new
</span>
<span class="source-lf">
 
</span>
<span class="source-lf entity-name-type-lflang">
Foo
</span>
<span class="source-lf">
()
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
state
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-lflang">
timer_triggered
</span>
<span class="source-lf">
:
</span>
<span class="source-lf meta-embedded-block-cpp">
 
</span>
<span class="source-lf meta-embedded-block-cpp storage-type-lflang">
bool
</span>
<span class="source-lf meta-embedded-block-cpp">
 
</span>
<span class="source-lf">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf constant-language-lflang">
false
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
timer
</span>
<span class="source-lf">
 t(
</span>
<span class="source-lf constant-numeric-int-lflang">
0
</span>
<span class="source-lf">
, {
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 get_delay() 
</span>
<span class="source-lf keyword-operator-lflang">
+
</span>
<span class="source-lf">
 200ms 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
})
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(
</span>
<span class="source-lf">
t) {
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>

<span class="source-lf">
    timer_triggered 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf constant-language-lflang">
true
</span>
<span class="source-lf">
;
</span>

<span class="source-lf">
    if (get_elapsed_logical_time() 
</span>
<span class="source-lf keyword-operator-lflang">
%
</span>
<span class="source-lf">
 400ms !
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
Duration
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
zero
</span>
<span class="source-lf">
()) {
</span>

<span class="source-lf">
      
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
std
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
cerr
</span>
<span class="source-lf">
 << 
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf string-quoted-double-lflang">
ERROR: timer triggered at an unexpected time
</span>
<span class="source-lf string-quoted-double-lflang constant-character-escape">
\n
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf">
;
</span>

<span class="source-lf">
      exit(
</span>
<span class="source-lf constant-numeric-int-lflang">
4
</span>
<span class="source-lf">
);
</span>

<span class="source-lf">
    }
</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(
</span>
<span class="source-lf support-variable-lflang">
shutdown
</span>
<span class="source-lf">
) {
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>

<span class="source-lf">
    if (!timer_triggered) {
</span>

<span class="source-lf">
      
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
std
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
cerr
</span>
<span class="source-lf">
 << 
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf string-quoted-double-lflang">
ERROR: timer did not trigger
</span>
<span class="source-lf string-quoted-double-lflang constant-character-escape">
\n
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf">
;
</span>

<span class="source-lf">
      exit(
</span>
<span class="source-lf constant-numeric-int-lflang">
2
</span>
<span class="source-lf">
);
</span>

<span class="source-lf">
    }
</span>

<span class="source-lf">

</span>

<span class="source-lf">
    
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
std
</span>
<span class="source-lf keyword-operator-lflang">
::
</span>
<span class="source-lf variable-other-lflang">
cout
</span>
<span class="source-lf">
 << 
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf string-quoted-double-lflang">
Success
</span>
<span class="source-lf string-quoted-double-lflang constant-character-escape">
\n
</span>
<span class="source-lf string-quoted-double-lflang">
"
</span>
<span class="source-lf">
;
</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
}
</span>

<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

