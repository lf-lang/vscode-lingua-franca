<span class="source-lf comment-line-double-dash-lflang">
# Example in the Wiki.
</span>

<span class="source-lf meta-targetspec-lflang keyword-control-lflang">
target
</span>
<span class="source-lf meta-targetspec-lflang">
 
</span>
<span class="source-lf meta-targetspec-lflang constant-language-lflang">
Python
</span>

<span class="source-lf">

</span>

<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf">
 
</span>
<span class="source-lf entity-name-type-lflang">
Scale
</span>
<span class="source-lf">
(scale
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf constant-numeric-int-lflang">
2
</span>
<span class="source-lf">
) {
</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
input
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-lflang">
x
</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
output
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-lflang">
y
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(x) 
</span>
<span class="source-lf keyword-operator-lflang">
->
</span>
<span class="source-lf">
 y 
</span>
<span class="source-lf meta-embedded-block-py">
{=
</span>

<span class="source-lf meta-embedded-block-py">
    y.set(x.value * self.scale)
</span>

<span class="source-lf meta-embedded-block-py">
  
</span>
<span class="source-lf meta-embedded-block-py">
=}
</span>

<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf">
 
</span>
<span class="source-lf entity-name-type-lflang">
Test
</span>
<span class="source-lf">
 {
</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
input
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-lflang">
x
</span>

<span class="source-lf">
  
</span>
<span class="source-lf storage-modifier-lflang">
state
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-lflang">
received_value
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf constant-numeric-int-lflang">
0
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(x) 
</span>
<span class="source-lf meta-embedded-block-py">
{=
</span>

<span class="source-lf meta-embedded-block-py">
    print("Received " + str(x.value))
</span>

<span class="source-lf meta-embedded-block-py">
    self.received_value = True
</span>

<span class="source-lf meta-embedded-block-py">
    if x.value != 2:
</span>

<span class="source-lf meta-embedded-block-py">
      sys.stderr.write("ERROR: Expected 2!")
</span>

<span class="source-lf meta-embedded-block-py">
      exit(1)
</span>

<span class="source-lf meta-embedded-block-py">
  
</span>
<span class="source-lf meta-embedded-block-py">
=}
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(
</span>
<span class="source-lf support-variable-lflang">
shutdown
</span>
<span class="source-lf">
) 
</span>
<span class="source-lf meta-embedded-block-py">
{=
</span>

<span class="source-lf meta-embedded-block-py">
    if self.received_value is None:
</span>

<span class="source-lf meta-embedded-block-py">
      sys.stderr.write("ERROR: No value received by Test reactor!")
</span>

<span class="source-lf meta-embedded-block-py">
    else:
</span>

<span class="source-lf meta-embedded-block-py">
      sys.stderr.write("Test passes.")
</span>

<span class="source-lf meta-embedded-block-py">
  
</span>
<span class="source-lf meta-embedded-block-py">
=}
</span>

<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

<span class="source-lf storage-modifier-lflang">
main
</span>
<span class="source-lf">
 
</span>
<span class="source-lf storage-modifier-lflang">
reactor
</span>
<span class="source-lf">
 
</span>
<span class="source-lf entity-name-type-lflang">
Gain
</span>
<span class="source-lf">
 {
</span>

<span class="source-lf">
  
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
g
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-control-new-lflang">
new
</span>
<span class="source-lf">
 
</span>
<span class="source-lf entity-name-type-lflang">
Scale
</span>
<span class="source-lf">
()
</span>

<span class="source-lf">
  
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
d
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-operator-lflang">
=
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-control-new-lflang">
new
</span>
<span class="source-lf">
 
</span>
<span class="source-lf entity-name-type-lflang">
Test
</span>
<span class="source-lf">
()
</span>

<span class="source-lf">
  
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
g
</span>
<span class="source-lf keyword-operator-lflang">
.
</span>
<span class="source-lf variable-other-lflang">
y
</span>
<span class="source-lf">
 
</span>
<span class="source-lf keyword-operator-lflang">
->
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
d
</span>
<span class="source-lf keyword-operator-lflang">
.
</span>
<span class="source-lf variable-other-lflang">
x
</span>

<span class="source-lf">

</span>

<span class="source-lf">
  
</span>
<span class="source-lf keyword-control-lflang">
reaction
</span>
<span class="source-lf">
(
</span>
<span class="source-lf support-variable-lflang">
startup
</span>
<span class="source-lf">
) 
</span>
<span class="source-lf keyword-operator-lflang">
->
</span>
<span class="source-lf">
 
</span>
<span class="source-lf variable-other-constant-reactorinstance-lflang">
g
</span>
<span class="source-lf keyword-operator-lflang">
.
</span>
<span class="source-lf variable-other-lflang">
x
</span>
<span class="source-lf">
 
</span>
<span class="source-lf meta-embedded-block-py">
{=
</span>

<span class="source-lf meta-embedded-block-py">
    g.x.set(1)
</span>

<span class="source-lf meta-embedded-block-py">
  
</span>
<span class="source-lf meta-embedded-block-py">
=}
</span>

<span class="source-lf">
}
</span>

<span class="source-lf">

</span>

